package teamseer_core_api;

import javax.jws.WebService;
import javax.xml.namespace.QName;
import javax.xml.rpc.ServiceException;

import org.apache.axis.description.FieldDesc;
import org.apache.axis.utils.BeanPropertyDescriptor;

import java.net.URL;
import java.rmi.RemoteException;
import java.text.DateFormat;
import java.util.Arrays;
import java.util.Date;


@WebService 
public class TimeMangerConnection {
	
	public static final String teamSeerWSDLloc = "https://www.teamseer.com/services/soap/coreapi/1_0_0/teamseer_core_api.wsdl";
	public static final String teamSeerKey = "3795bae113";
	public static final String teamSeerVersion = "1_0_0";
	public static final int teamSeerCompanyId = 1576;
	
	public static void main(String[] args) {
		
		try {
			
			Teamseer_core_apiServiceLocator service = new Teamseer_core_apiServiceLocator();
			
			service.setMaintainSession(true);
			boolean isMaintained = service.getMaintainSession();
			System.out.println( "Session Maintained: " + isMaintained );
			
			
			Teamseer_core_apiBindingStub bindingStub = new Teamseer_core_apiBindingStub(new URL(service.getteamseer_core_apiPortAddress()), service);
			boolean isAuthenticated = bindingStub.authenticate(teamSeerCompanyId, teamSeerKey, teamSeerVersion);
			
			System.out.println( "Authenticated: " + isAuthenticated );
			
			if (isAuthenticated) {
				String[] users = bindingStub.getActiveUsers();
				System.out.println( Arrays.toString(users) );
				System.out.println( users.length );
				
				System.out.println(bindingStub.setDateFormat("yyyy-mm-dd"));
				
				for (String user : users) {
					DayActivityAPI[] dayArray = bindingStub.getRecordsFor( user, "2015-05-05", "2015-06-06");
					if ( dayArray.length != 0  && (user.contains("awainwright") /*|| user.contains("wzyli")*/ ) ) {
						System.out.println(Arrays.toString(dayArray));
						
						for (int i = 0; i < dayArray.length; i++) {
							System.out.println("Date: " + dayArray[i].getDate());
							System.out.println("CategoryArr: " + dayArray[i].getCategoryArr());
							System.out.println("User Identifier: " + dayArray[i].getUserIdentifier().);
							System.out.println("Status String: " + dayArray[i].getStatusStr());
							System.out.println("TypeString: " + dayArray[i].getTypeStr());
							
							
						}
						FieldDesc[] fields = DayActivityAPI.getTypeDesc().getFields();
						BeanPropertyDescriptor names = DayActivityAPI.getTypeDesc().getAnyDesc();
						BeanPropertyDescriptor stuff = DayActivityAPI.getTypeDesc().getAnyContentDescriptor();
						//Object stuff2 = DayActivityAPI.getTypeDesc();
						for (int j = 0; j < fields.length; j++) {
							System.out.println(fields[j].getFieldName() + " " + fields[j].getXmlName().toString());
							
						}
						System.out.println(names.getName());
						System.out.println(stuff.getName());
					}
					
					
					
				}
				
			}
			
			
		} catch (Exception e) {
			System.out.println(e.getMessage());
			e.printStackTrace();
		}
		
	} // end of main
	
	
	public void doStuff(){
		
	}

}
